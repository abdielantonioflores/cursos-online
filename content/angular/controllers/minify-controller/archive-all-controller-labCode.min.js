
app.controller("ctrl-inicio-session",["$scope","$http","Dataservice",function(e,s,o){var{cookie:r}=plugdo;e.user=[],e.sessionStart=!0,e.userActive=!0;var n=r.get("session-exist");function t(){if(""!=n){var s=JSON.parse(n);e.name=s.name,e.sessionStart=!0,e.userActive=!1,a(s),i(s)}else{if(""!=e.user)e.sessionStart=!0,e.userActive=!1,e.name=e.user[0].name,i(s=e.user[0]),a(s);else e.sessionStart=!1,e.userActive=!0}}function i(s){s={id_usuario:s.id};o.GetShoppingCart(s).then(function(s){countShoping=s.data.save.length,e.countShopping=countShoping})}function a(o){var r={id_usuario:o.id};s.post(FindMycourses,r).then(function(s){1==s.data.ok&&(e.countMycourses=s.data.save.length)})}e.session_start=function(){form=$("#formSesion").serializeArray(),obj=new Object;for(const e in form)obj[form[e].name]=form[e].value;""!=obj.email&&""!=obj.password?function(o){s.post(GetUsers,o).then(function(s){var o=s.data.ok;if(1==o&&0!=s.data.save.length){var n=s.data.save[0];e.user=[],e.user.push({name:n.nombre,id:n._id,email:n.email});var i=JSON.stringify(e.user[0]);r.set("session-exist",i,1),swal("Bien !",`Hola Bienvenido ${n.nombre}`,"success"),$("#inicio").modal("hide"),t()}else swal("Este Usuario no existe ","Intenta Registrarte","error")})}(obj):swal("Error!","Datos Incompletos","error")},e.register_users=function(){form=$("#formRegister").serializeArray(),obj=new Object;for(const e in form)obj[form[e].name]=form[e].value;""!=obj.nombre&&""!=obj.email&&""!=obj.password?function(o){s.post(SendUsers,o).then(function(s){var o=s.data.ok;if(1==o){var n=s.data.save;e.user=[],e.user.push({name:n.nombre,id:n._id,email:n.email});var i=JSON.stringify(e.user[0]);r.set("session-exist",i,1),swal("Bien !","Te has registrado correctamente ","success"),$("#registro").modal("hide"),t()}else swal("Error!","Intentalo nuevamente","error")})}(obj):swal("Error!","Datos Incompletos","error")},e.close_session=function(){r.delete("session-exist"),location.href="/"},e.loadShoppingCart=function(){location.href="/shopping-cart"},t()}]);


app.controller("filter-cursos",["$scope","$http","Dataservice",function(e,o,t){e.categorias="";var{cookie:a}=plugdo;e.user=[];var r=a.get("session-exist");e.FunctCategorias=function(t){!function(t){o.post(findCours,t).then(function(o){e.dataCourses=o.data.save,e.countCourses=o.data.save.length,""!=e.dataCourses&&(alertify.set("notifier","position","top-right"),alertify.success(`${e.countCourses} Resultados `))})}({id:t.id_categoria})},e.AddShoppingCard=function(e){null!=r&&""!=r?function(e){t.InsertShoppingCartLabCode(e).then(function(e){var o=e.data.ok;1==o?swal({title:"Listo ",text:"Se agrego correctamente, desea ver el estado de tu carritode compra o quieres seguir comprando",icon:"success",buttons:["Seguir comprando","Ver carrito"],dangerMode:!0}).then(e=>{!0===e&&(location.href="/shopping-cart")}):swal("Error!","Verifica que tu conexion este bien ","warning")})}({id_usuario:JSON.parse(r).id,id_categoria:e.id_categoria,id_Curso:e.id_Curso,Titulo:e.Titulo,Precio:e.Precio,nombre_profesor:e.nombre_profesor,Informacion:e.Informacion,Imagen:e.Imagen}):swal({title:"HUPS!",text:"No tienes una cuenta con Nosotros ?",icon:"warning",buttons:["Iniciar sesi贸n","Crear cuenta"],dangerMode:!0}).then(e=>{1==e?$("#registro").modal("show"):$("#inicio").modal("show")})},o.get(getCategories).then(function(o){e.categorias=o.data.save}),o.get(getCourses).then(function(o){e.dataCourses=o.data.save,e.countCourses=o.data.save.length,e.totalItems=30,e.currentPage=1,e.itemsPerPage=6,e.maxSize=5,e.setPage=function(o){e.currentPage=o},e.setPage=function(o){e.currentPage=o},e.pageChanged=function(){Pselect=e.currentPage,$("html, body").animate({scrollTop:0},"slow")}})}]);


app.controller("My-courses",["$scope","$http","Dataservice",function(s,t,e){var{cookie:a}=plugdo;s.user=[],s.sessionStart=!0,s.userActive=!0;var i=a.get("session-exist");function o(s){var e={id_usuario:s.id};t.post(FindMycourses,e).then(function(s){1==s.data.ok&&function(s){for(const e in s){var t={id_Curso:s[e].id_Curso};n(t)}}(s.data.save)})}function n(e){t.post(MycoursesList,e).then(function(t){if(1==t.data.ok){var e=t.data.save[0];s.dataList.push(e)}})}s.dataList=[],function(){if(""!=i){var t=JSON.parse(i);s.name=t.name,s.sessionStart=!0,s.userActive=!1,o(t)}else""!=s.user?(s.sessionStart=!0,s.userActive=!1,s.name=s.user[0].name,o(t=s.user[0])):(s.sessionStart=!1,s.userActive=!0)}()}]);


app.controller("payment-courses",["$scope","$http","Dataservice",function(e,a,t){let{cookie:o}=plugdo;e.user=[];var n=[];e.dataPayment="";var r=o.get("session-exist"),s=o.get("data-payment"),i=o.get("data-total");if(null!=r){var l=JSON.parse(r);e.name=l.name,e.email=l.email}function c(){if(""!=s){var a=JSON.parse(s);e.countArticle=a.length,e.article=a,e.Total=i,e.dataPayment=a}}""===s&&null===s&&(location.href="/"),e.paymentCourses=function(){var t=new Date,o=t.getDate(),s=t.getMonth()+1+"/"+o+"/"+t.getFullYear();form=$("#formDataTarjeta").serializeArray(),form.push({name:"dia",value:s}),obj=new Object;for(const e in form)obj[form[e].name]=form[e].value;!function(t){""!=t.Ma&&""!=t.CodePostal&&""!=t.cvc&&""!=t.dia&&""!=name_tarjeta&&""!=num_tarjeta?swal({title:"LabCode",text:"Estas seguro que quieres Realizar este pago.",icon:"warning",buttons:!0,dangerMode:!0}).then(o=>{1==o&&function(t){var o={id_usuario:JSON.parse(r).id,dia:t.dia,Total:e.Total,cursos:e.countArticle};a.post(inserPayment,o).then(function(t){var o=t.data.ok;1==o&&(swal("Good job!","Has realizado correctamente la compra","success",{button:"listo"}),n={name:e.name,email:e.email,cantidad:e.dataPayment.length,total:e.Total},a.post(UrlEmail,n).then(function(a){200==a.status&&(swal("Good!","Se ha realizado el pago correctamente ","success"),function(){var a=e.article;for(const t in a)e.saveMycourses(a[t])}())}))})}(t)}):swal({title:"LabCode",text:"Todos los campos son obligatorios",icon:"error",buttons:!0,dangerMode:!0}).then(e=>{})}(obj)},e.deleteCourses=function(n){var s={id:n._id};a.post(deleteShopping,s).then(function(a){var n;1==a.data.ok?(n=JSON.parse(r),t.GetShoppingCart(n).then(function(a){e.countShopping=a.data.save.length,0==e.countShopping&&(o.delete("data-payment"),location.href="/mis-cursos")})):swal("Error!","No se completo la operaci贸n","error")})},e.saveMycourses=function(t){var o={id_usuario:t.id_usuario,id_Curso:t.id_Curso};a.post(inserMycourses,o).then(function(a){1==a.data.ok&&function(){var a=e.article;for(const t in a)e.deleteCourses(a[t])}()})},function(){if(""!=r){var a=JSON.parse(r);e.name=a.name,c()}else""!=e.user?(e.name=e.user[0].name,a=e.user[0],c()):(location.href="/",o.delete("session-exist"))}()}]);


app.controller("shopping-cart",["$scope","$http","Dataservice",function(t,e,n){var{cookie:o}=plugdo;t.user=[],t.Total=0,t.Shopping="";var a=o.get("session-exist");t.lengthEmpty=!0;function i(e){e={id_usuario:e.id};n.GetShoppingCart(e).then(function(e){t.countShopping=e.data.save.length,0==t.countShopping?t.lengthEmpty=!1:t.lengthEmpty=!0,t.Shopping=e.data.save,function(e){if(0!=e.length)for(var n=0;n<e.length;n++)t.Total+=e[n].Precio;o.set("data-total",t.Total,1)}(t.Shopping)})}t.deleteCourses=function(t){var n={id:t._id};e.post(deleteShopping,n).then(function(t){1==t.data.ok?(swal("Listo!","Producto eliminado","success"),setTimeout(()=>{location.href="/shopping-cart"},1e3)):swal("Error!","No se completo la operaci贸n","error")})},t.ListPayment=function(){var e={id_usuario:JSON.parse(a).id};n.GetShoppingCart(e).then(function(e){if(t.countShopping=e.data.save,0==t.countShopping)t.lengthEmpty=!1;else{t.lengthEmpty=!0;var n=JSON.stringify(t.countShopping);o.set("data-payment",n,1),location.href="/payment"}})},function(){if(""!=a){var e=JSON.parse(a);t.name=e.name,i(e)}else""!=t.user?(t.name=t.user[0].name,i(e=t.user[0])):(location.href="/",o.delete("session-exist"))}()}]);


app.controller("view-courses",["$scope","$http","Dataservice",function(o,e,n){let{url:i,cookie:r}=plugdo;o.user=[];var t=r.get("session-exist");i.qs.length>0&&function(n){e.post(getCourse,n).then(function(e){o.dataCourse=e.data.save[0]})}({id:i.qs.courses});o.AddShoppingCard=function(o){null!=t&&""!=t?function(o){n.InsertShoppingCartLabCode(o).then(function(o){var e=o.data.ok;1==e?(swal("Listo!","Se agrego correctamente","success"),setTimeout(()=>{location.href="/shopping-cart"},3e3)):swal("Error!","Verifica que tu conexion este bien ","warning")})}({id_usuario:JSON.parse(t).id,id_categoria:o.id_categoria,id_Curso:o.id_Curso,Titulo:o.Titulo,Precio:o.Precio,nombre_profesor:o.nombre_profesor,Informacion:o.Informacion,Imagen:o.Imagen}):swal({title:"HUPS!",text:"No tienes una cuenta con Nosotros?",icon:"warning",buttons:["Iniciar sesi贸n","Crear cuenta"],dangerMode:!0}).then(o=>{1==o?$("#registro").modal("show"):$("#inicio").modal("show")})}}]);